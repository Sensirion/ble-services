# yaml-language-server: $schema=./ble-service-schema.json
file-version: 0.1.0

ble-services:

  - service:
      name: Reboot Device Service
      uuid: e6686821-f5b0-417f-aa27-89d1a1ae5425
      description: |
        Trigger the reboot or the over the air update (OTA).
        This service uses the ST OTA application that is flashed on the
        demo board and acts as boot loader.
      supported-characteristics:
        - characteristic:
            name: Reboot request
            uuid: 0000FE11-8e22-4541-9d4c-21edae82ed19
            description: |
              Trigger the reboot or OTA by writing to the characteristic.
              The characteristic requires three bytes as parameter:
              - byte[0]: Boot mode: 0 = SHT application, 1 = OTA application
              - byte[1]: First sector to be erased (7 for demo board firmware)
              - byte[2]: Number of sectors to erase.
                (0-57; device settings start at page 65)
            data-type: uint8[3]
            access-properties: [write]

  - service:
      name: Relative Humidity Service
      uuid: 00001234-B38D-4985-720E-0F993A68EE41
      description: |
        Allows to be notified when the measured humidity changes. This service
        could be replaced by the BLE environmental service.
      supported-characteristics:
        - characteristic:
            name: Relative humidity
            uuid: 00001235-B38D-4985-720E-0F993A68EE41
            description: Measured relative humidity in %.
            data-type: uint8
            access-properties: [read, notify]

  - service:
      name: Temperature service
      uuid: 00002234-B38D-4985-720E-0F993A68EE41
      description: |
        Allows to be notified when the temperature changes. This service could
        be replaced by the BLE environmental service.
      supported-characteristics:
        - characteristic:
            name: Temperature
            uuid: 00002235-B38D-4985-720E-0F993A68EE41
            description: Temperature in degree celsius.
            data-type: float
            access-properties:  [read, notify]

  - service:
      name: SHT serial number service
      uuid: 00006000-B38D-4985-720E-0F993A68EE41
      description: Serial number of the embedded sht sensor
      supported-characteristics:
        - characteristic:
            name: Serial number
            uuid: 00006001-B38D-4985-720E-0F993A68EE41
            description: Serial number
            data-type: uint32
            access-properties: [read]

  - service:
      name: Battery Service
      uuid: 0000180f-0000-1000-8000-00805f9b34fb
      ble-sig-reference: https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=554952
      supported-by: ["SHT43-DB"]
      description: Allows to get the battery level from the measuring device.
      supported-characteristics:
        - characteristic:
            name: Battery Level
            uuid: "2a19"
            description: "The current battery level expressed as % of the available capacity."
            data-type: uint8
            access-properties: [read, notify]

  - service:
      name: Data Logger Service
      uuid: 00008000-B38D-4985-720E-0F993A68EE41
      description: Service to control the data logging on a measuring device.
      application-note: |
        How to use the service:

          #. To be able to calculate how many samples we have missed; the sampling interval has to be readout.

          #. The measuring device returns the sampling interval in milliseconds.

          #. Then we check how many samples are available at all.

          #. The measuring device returns the number of available samples.

          #. Based on the retrieved information, we determine how many samples we want to read. If the requested
             number of samples is higher than the available number of samples, then all available samples are
             transmitted.

             If the requested number of samples is less than the available number of samples, the oldest samples are
             omitted. If the requested number of samples is not specified, then all available samples are transmitted.

        The steps 1 to 5 are optional, they are only required if not all samples should be transferred by the Data Logger.
        This is useful if older samples have already been read from the logger and only the missing new samples are to
        be transferred.
      supported-characteristics:
        - characteristic:
            name: Logging interval
            uuid: 00008001-B38D-4985-720E-0F993A68EE41
            description: |
              The time between two subsequent measurements in milliseconds.
              Note: When the logging interval is changed, the logged samples will be removed.
            data-type: uint32
            access-properties: [read, write]
        - characteristic:
            name: Available samples
            uuid: 00008002-B38D-4985-720E-0F993A68EE41
            description: Get the number of samples that is available on the measuring device
            data-type: uint16
            access-properties: [read]
        - characteristic:
            name: Requested samples
            uuid: 00008003-B38D-4985-720E-0F993A68EE41
            description: Get or set the number of samples that are to be transferred
            data-type: uint16
            access-properties: [read, write]
        - characteristic:
            name: Data transfer
            uuid: 00008003-B38D-4985-720E-0F993A68EE41
            description: Notify the client that a new block of samples has been sent.
            data-type: uint8[20]
            access-properties: [notify]
  - service:
      name: Device settings
      uuid: 00008100-B38D-4985-720E-0F993A68EE41
      description: |
        This service contains various device settings that can be modified by a user.

      supported-characteristics:
        - characteristic:
            name: Device settings version
            uuid: 000081FF-B38D-4985-720E-0F993A68EE41
            description: |
              The actual version of the device settings. This version depends on the actual
              firmware of a device and cannot be modified by a user. When a firmware uses new settings version it shall
              import values that where previously set by the user if these values are still applicable.
            data-type: uint8
            access-properties: ["read"]
        - characteristic:
            name: Alternative device name
            uuid: 00008120-B38D-4985-720E-0F993A68EE41
            description: |
              A name for the device that can be set by a user and shown instead of the device name
              that is part of the Generic Access Profile (uuid 0x2a00). The maximal length of the
              name is 32 characters.
            data-type: string[32]
            access-properties: [read, write]
        - characteristic:
            name: Is debug log enabled
            uuid: 000081FE-B38D-4985-720E-0F993A68EE41
            description: |
              This flag allows to enable or disable debug traces to the UART. By default UART trace
              is disabled.

              *Note:* Enabling tracing will cause higher current consumption and therefore
              reduce battery lifetime!
            data-type: bool
            access-properties: [read,write]
        - characteristic:
            name: Advertise sensor data
            uuid: 00008130-B38D-4985-720E-0F993A68EE41
            description: Flag to enable/ disable the advertisement of sensor data.
            data-type: bool
            access-properties: [read, write]
